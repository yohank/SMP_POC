/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.core.DeclarativeSupport");sap.ui.core.DeclarativeSupport={};sap.ui.core.DeclarativeSupport.attributes={"data-sap-ui-type":true,"data-sap-ui-aggregation":true,"data-sap-ui-default-aggregation":true,"data-tooltip":function(v,s){s["tooltip"]=v},"tooltip":function(v,s,c){s["tooltip"]=v;jQuery.sap.log.warning('[Deprecated] Control "'+c.getId()+'": The attribute "tooltip" is not prefixed with "data-*". Future version of declarative support will only suppport attributes with "data-*" prefix.')},"class":function(v,s,c){c.addStyleClass(v)},"style":true,"id":true};
sap.ui.core.DeclarativeSupport.compile=function(e){var s=this;jQuery(e).find("[data-sap-ui-type]").filter(function(){return jQuery(this).parents("[data-sap-ui-type]").length===0}).each(function(){s._compile(this)})};
sap.ui.core.DeclarativeSupport._compile=function(e){var $=jQuery(e);var t=$.attr("data-sap-ui-type");var c=[];if(t==="sap.ui.core.UIArea"){var s=this;$.children().each(function(){var C=s._createControl(this);if(C){c.push(C)}})}else{var C=this._createControl(e);if(C){c.push(C)}}$.empty();$.removeAttr("data-sap-ui-type");jQuery.each(c,function(k,C){if(C instanceof sap.ui.core.Control){C.placeAt(e)}})};
sap.ui.core.DeclarativeSupport._createControl=function(e){var $=jQuery(e);var c=null;var t=$.attr("data-sap-ui-type");if(t){var C=jQuery.sap.getObject(t);var c=new C(this._getId($));var s={};this._addSettingsForAttributes(s,c,e);this._addSettingsForAggregations(s,c,e);c.applySettings(s);$.removeAttr("data-sap-ui-type")}else{c=this._createHtmlControl(e)}return c};
sap.ui.core.DeclarativeSupport._createHtmlControl=function(e){var h=new sap.ui.core.HTML();h.setDOMContent(e);this.compile(e);return h};
sap.ui.core.DeclarativeSupport._addSettingsForAttributes=function(s,c,e){var a=this;var S=sap.ui.core.DeclarativeSupport.attributes;jQuery.each(e.attributes,function(i,A){var n=A.name;var v=A.value;if(typeof S[n]==="undefined"){n=a._convertAttributeToSettingName(c,n);var p=a._getProperty(c,n);if(p){s[n]=a._convertValueToPropertyType(p,v)}else if(a._getAssociation(c,n)){s[n]=v}else if(a._getEvent(c,n)){var h=jQuery.sap.getObject(v);if(typeof h==="function"){s[n]=h}else{throw new Error('Control "'+c.getId()+'": The function "'+v+'" for the event "'+n+'" is not defined')}}}else if(typeof S[n]==="function"){S[n](v,s,c)}});return s};
sap.ui.core.DeclarativeSupport._addSettingsForAggregations=function(s,c,e){var $=jQuery(e);var d=this._getDefaultAggregation(c,e);var a=this;var A=c.getMetadata().getAllAggregations();$.children().each(function(){var b=jQuery(this);var f=b.attr("data-sap-ui-aggregation");var t=b.attr("data-sap-ui-type");var u=false;if(!f){u=true;f=d}if(f&&A[f]){var m=A[f].multiple;var g=function(C){var c=a._createControl(C);if(c){if(m){s[f]=s[f]||[];s[f].push(c)}else{s[f]=c}}};if(u||(t&&!u)){g(this)}else{b.children().each(function(){g(this)})}}b.removeAttr("data-sap-ui-aggregation");b.removeAttr("data-sap-ui-type")});return s};
sap.ui.core.DeclarativeSupport._getId=function(e){var $=jQuery(e);var i=$.attr("id");if(i){$.attr("id","")}return i};
sap.ui.core.DeclarativeSupport._getProperty=function(c,n){return c.getMetadata().getAllProperties()[n]};
sap.ui.core.DeclarativeSupport._convertValueToPropertyType=function(p,v){if(!this._isBindingExpression(v)){var t=this._getPropertyDataType(p);if(t instanceof sap.ui.base.DataType){v=t.parseValue(v)}}return v};
sap.ui.core.DeclarativeSupport._isBindingExpression=function(v){return v&&v.slice(0,1)==='{'&&v.slice(-1)==='}'};
sap.ui.core.DeclarativeSupport._getPropertyDataType=function(p){var t=sap.ui.base.DataType.getType(p.type);if(!t){throw new Error("Property "+p.name+" has no known type")}return t};
sap.ui.core.DeclarativeSupport._convertAttributeToSettingName=function(c,a){if(a.indexOf("data-")===0){a=a.substr(5)}else{jQuery.sap.log.warning('[Deprecated] Control "'+c.getId()+'": The attribute "'+a+'" is not prefixed with "data-*". Future version of declarative support will only suppport attributes with "data-*" prefix.')}return jQuery.sap.camelCase(a)};
sap.ui.core.DeclarativeSupport._getAssociation=function(c,n){return c.getMetadata().getAllAssociations()[n]};
sap.ui.core.DeclarativeSupport._getEvent=function(c,n){return c.getMetadata().getAllEvents()[n]};
sap.ui.core.DeclarativeSupport._getDefaultAggregation=function(c,e){var $=jQuery(e);var d=$.attr("data-sap-ui-default-aggregation")||c.getMetadata().getDefaultAggregationName();$.removeAttr("data-sap-ui-default-aggregation");return d};
