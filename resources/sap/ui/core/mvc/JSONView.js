/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.core.mvc.JSONView");jQuery.sap.require("sap.ui.core.library");jQuery.sap.require("sap.ui.core.mvc.View");sap.ui.core.mvc.View.extend("sap.ui.core.mvc.JSONView",{metadata:{library:"sap.ui.core"}});(function(){sap.ui.jsonview=function(i,v){var s={};if(v){if(typeof(v)=="string"){s.viewName=v}else{s.viewName=v.viewName;s.controller=v.controller;s.viewContent=v.viewContent}return new sap.ui.core.mvc.JSONView(i,s)}else{if(typeof(i)=="string"){s.viewName=i}else{s.viewName=i.viewName;s.controller=i.controller;s.viewContent=i.viewContent}return new sap.ui.core.mvc.JSONView(s)}};sap.ui.core.mvc.JSONView.prototype.initViewSettings=function(s){if(!s){throw new Error("mSettings must be given")}if(s.viewName&&s.viewContent){throw new Error("View name and view content are given. There is no point in doing this, so please decide.")}else if(!s.viewName&&!s.viewContent){throw new Error("Neither view name nor view content is given. One of them is required.")}if(s.viewName){this._loadTemplate(s.viewName)}else if(s.viewContent){this.mProperties["viewContent"]=s.viewContent;if(typeof s.viewContent==="string"){this._oJSONView=jQuery.parseJSON(s.viewContent);if(!this._oJSONView){throw new Error("error when parsing viewContent: "+s.viewContent)}}else if(typeof s.viewContent==="object"){this._oJSONView=s.viewContent}else{throw new Error("viewContent must be a JSON string or object, but is a "+(typeof s.viewContent))}}else{}if(this._oJSONView.resourceBundleName||this._oJSONView.resourceBundleUrl){var m=new sap.ui.model.resource.ResourceModel({bundleName:this._oJSONView.resourceBundleName,bundleUrl:this._oJSONView.resourceBundleUrl});this.setModel(m,this._oJSONView.resourceBundleAlias)}};sap.ui.core.mvc.JSONView.prototype.onControllerConnected=function(c){var t=this;sap.ui.core.Element.runWithPreprocessors(function(){t.applySettings({content:t._oJSONView.content})},{id:function(i){return i.indexOf(t.createId(""))===0?i:t.createId(i)},settings:function(s){var m=this.getMetadata(),v=m.getJSONKeys(),k,V,K;for(k in s){if(K=v[k]){V=s[k];switch(K._iKind){case 3:s[k]=t.createId(V);break;case 5:if(typeof s[k]==="string"){s[k]=[c[s[k]],c]}break}}}}})};sap.ui.core.mvc.JSONView.prototype._loadTemplate=function(t){var u=jQuery.sap.getModulePath(t,".view.json");var r=jQuery.sap.sjax({url:u,dataType:'json'});this._oJSONView=r.data;if(!this._oJSONView){throw new Error("View definition could not be loaded from "+u+". Check for 'file not found' errors.")}};sap.ui.core.mvc.JSONView.prototype.getControllerName=function(){return this._oJSONView.controllerName}}());
